rules_version = '2';

service cloud.firestore {
match /databases/{database}/documents {

// (⭐️ DELETED) 'scores' 컬렉션 규칙은 더 이상 사용하지 않으므로 삭제합니다.

// (⭐️ NEW) users: 사용자의 점수 기록. 본인만 생성/수정 가능하며, 누구나 읽을 수 있습니다.
match /users/{userId} {
  allow read;
  allow create, update: if request.auth.uid == userId;
  allow delete: if false;
}

// seasons: 단어 데이터는 누구나 읽기만 가능합니다.
match /seasons/{seasonId} {
  allow read;
  allow write: if false;
}

// emails: 본인의 uid를 문서 ID로 사용, 본인만 생성/읽기 가능
match /emails/{userId} {
  allow read, create: if request.auth.uid == userId;
  allow update, delete: if false;
}

// attempts: 사용자는 자신의 도전 기록만 읽고 쓸 수 있습니다.
match /attempts/{userId} {
  allow read, write: if request.auth.uid == userId;
}

// (⭐️ NEW) leaderboards: 캐시된 랭킹 데이터. 클라이언트는 읽기만 가능합니다.
match /leaderboards/{docId} {
    allow read;
    allow write: if false; // 서버(Cloud Functions)에서만 쓰기 작업을 수행합니다.
}

}
}